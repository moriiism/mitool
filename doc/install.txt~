#
# install
#

programの置場はどこでもよい。
解析作業を行うdirectory と program の置場を別にした方がよい。

mxkwtool は、FFTW, minuit2, gsl を使用するので、
以下のようにしてconfigure した後、
root をコンパイルする必要がある。
従って、root を configure する前に、FFTW, minuit2, gsl を
install しておく必要がある。
ただし、最近のrootの場合、minuit2 が既に組み込まれているので、
minuit2 を個別にinstall する必要はない。

#
# FFTW の install の例
#

http://www.fftw.org/
---> download to /nfs/home/morii/localhome/admin/fftw/fftw-3.3.4.tar.gz

su root
# mkdir /soft/fftw/3.3.4
# chown morii /soft/fftw/3.3.4
# exit

/nfs/home/morii/localhome/admin/fftw/fftw-3.3.4.tar.gz
cd /nfs/home/morii/localhome/admin/fftw
tar xvfz fftw-3.3.4.tar.gz
cd fftw-3.3.4

./configure --enable-shared --prefix=/soft/fftw/3.3.4

make > make.log 2>&1 &
tail -f make.log

make install > make_install.log 2>&1 &
tail -f make_install.log

su root
# chown -R root /soft/fftw/3.3.4
# exit

#
# gsl の install の例
#

---> download to /nfs/home/morii/localhome/admin/gsl/gsl-1.16.tar.gz

su root
# mkdir /soft/gsl/1.16
# chown morii /soft/gsl/1.16
# exit

/nfs/home/morii/localhome/admin/gsl/gsl-1.16.tar.gz
cd /nfs/home/morii/localhome/admin/gsl
tar xvfz gsl-1.16.tar.gz
cd gsl-1.16

./configure  --prefix=/soft/gsl/1.16

make > make.log 2>&1 &
tail -f make.log

make install > make_install.log 2>&1 &
tail -f make_install.log

su root
# chown -R root /soft/gsl/1.16
# exit


#
# root の install の例
#

---> download to /nfs/home/morii/localhome/admin/root/root_v5.34.18.source.tar.gz 

su root
# mkdir /soft/root/5.34.18
# chown morii /soft/root/5.34.18
# exit

cd /nfs/home/morii/localhome/admin/root/
tar xvfz root_v5.34.18.source.tar.gz 
mv root root_v5.34.18
cd root_v5.34.18

./configure --prefix=/soft/root/5.34.18  --etcdir=/soft/root/5.34.18/etc \
--enable-minuit2 --enable-fftw3 --enable-mathmore \
--with-fftw3-incdir="/soft/fftw/3.3.4/include" \
--with-fftw3-libdir="/soft/fftw/3.3.4/lib" \
--with-gsl-incdir="/soft/gsl/1.16/include" \
--with-gsl-libdir="/soft/gsl/1.16/lib"


make > make.log 2>&1 &
tail -f make.log

make install > make_install.log 2>&1 &
tail -f make_install.log

###################################

現在自分が使っているroot がどのようにconfigure されたのかを調べるには、
  root -config
の出力を見る。

root を 速くcompile したければ、以下のようにすればよい。
（CPU が8 core ある場合)

   make -j 8


#
# mxkwtool をinstall する。
#

安定版：
   http://www.maxi.jaxa.jp/svnrepo_mission/common/mxkwtool/branches/3.5.1


su root 
# mkdir /soft/mxkwtool
# chown morii /soft/mxkwtool
# exit

cd /soft/mxkwtool
svn co http://www.maxi.jaxa.jp/svnrepo_mission/common/mxkwtool/branches/3.5.1  3.5.1
cd 3.5.1

環境に合わせて書き換える。

emacs Makefile.in &
emacs setup/setup_mxkwtool.sh &
emacs setup/maxi/setup_mxsoft_20131219.sh &

cd /soft/mxkwtool/3.4.22

make > make.log 2>&1 &
tail -f make.log

make install > make_install.log 2>&1 &
tail -f make_install.log

以上で、 install は完了。


################################################

不明な所は森井まで。

○ install がうまく行かないとき、

   problem.txt を読んでください。

○ おまけ

 heasarc site から data を download するスクリプト中で、ncftp を使用しているので install しておくとよい。

 # wget ftp://ftp.ncftp.com/ncftp/ncftp-3.2.1-src.tar.bz2
 # tar jxvf ncftp-3.2.1-src.tar.bz2
 # cd ncftp-3.2.1
 # ./configure --prefix=/usr
 # make
 # make install


○ 複数のユーザーが利用する場合、
   /tmp/mxkw_busy/
   /tmp/mxkw_run/
  のパーミッションを 777 にしておく。
  # chmod 777 /tmp/mxkw_busy
  # chmod 777 /tmp/mxkw_run


####################################################

maxireceive:
/dx2/mxdata_jax/auxil
/dx2/mxdata_jax/issatt

attitudeファイルのデータは
2013/12/16 (MJD=56642) - 2014/2/12(MJD=56700)
の間、軌道上のADS systemの不具合で正しくない。
ISSの補助データから換算されたissattにある姿勢データの方を使用する。






